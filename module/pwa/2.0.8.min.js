/*
 * Copyright 2018 Google Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var k=["standalone","fullscreen","minimal-ui"],S="#f8f9fa",_=24,x=128,I=48,C=32,e=navigator.userAgent||"",T=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")&&-1!==e.indexOf("Mobile/"),E=Boolean(e.match(/(MSIE |Edge\/|Trident\/)/)),R="undefined"!=typeof Windows;function t(){var e=document.head.querySelector('link[rel="manifest"]'),t=e?e.href:"";if(!t)throw'can\'t find <link rel="manifest" href=".." />\'';var n=function(n){for(var e=function(e){var t=n[e];try{return new URL("",t),{v:function(e){return new URL(e||"",t).toString()}}}catch(e){}},t=0;t<n.length;++t){var r=e(t);if("object"===_typeof(r))return r.v}return function(e){return e||""}}([t,window.location]),r=new XMLHttpRequest;r.open("GET",t),r.withCredentials="use-credentials"===e.getAttribute("crossorigin"),r.onload=function(){try{!function(h,r){var e=h.icons||[];e.sort(function(e,t){return parseInt(t.sizes,10)-parseInt(e.sizes,10)});var t=e.map(function(e){var t={rel:"icon",href:r(e.src),sizes:e.sizes};if(A("link",t),T){var n=parseInt(e.sizes,10);if(!(n<120))return t.rel="apple-touch-icon",t}}).filter(Boolean);if(t.length){var n=t[t.length-1];delete n.sizes}t=t.map(function(e){return A("link",e)});var a=document.head.querySelector('meta[name="viewport"]'),o=a&&a.content||"",i=Boolean(o.match(/\bviewport-fit\s*=\s*cover\b/)),l=h.display,c=-1!==k.indexOf(l);if(O("mobile-web-app-capable",c),function(e,t){if(T||R){var n=L(e);if(T){var r=t?"black-translucent":n?"black":"default";O("apple-mobile-web-app-status-bar-style",r)}else{var a=function(){try{return Windows.UI.ViewManagement.ApplicationView.getForCurrentView().titleBar}catch(e){}}();if(!a)return;a.foregroundColor=z(n?"black":"white"),a.backgroundColor=z(e)}}}(h.theme_color||"black",i),E){O("application-name",h.short_name),O("msapplication-tooltip",h.description),O("msapplication-starturl",r(h.start_url||".")),O("msapplication-navbutton-color",h.theme_color);var u=e[0];u&&O("msapplication-TileImage",r(u.src)),O("msapplication-TileColor",h.background_color)}document.head.querySelector('[name="theme-color"]')||O("theme-color",h.theme_color);if(!T){var s=(f=h.orientation,{por:"portrait",lan:"landscape"}[String(f||"").substr(0,3)]||"");return O("x5-orientation",s),O("screen-orientation",s),"fullscreen"===l?(O("x5-fullscreen","true"),O("full-screen","yes")):c&&(O("x5-page-mode","app"),O("browsermode","application"))}var f;var v=L(h.background_color||S),d=(p=h.related_applications,(p||[]).filter(function(e){return"itunes"===e.platform}).forEach(function(e){if(e.id)m=e.id;else{var t=e.url.match(/id(\d+)/);t&&(m=t[1])}}),m);var p,m;function g(e,t,n){var r=e.availWidth,a=e.availHeight,o=window.devicePixelRatio,i=B({width:r*o,height:a*o});if(i.scale(o,o),i.fillStyle=h.background_color||S,i.fillRect(0,0,r,a),i.translate(r/2,(a-C)/2),n){var l=n.width/o,c=n.height/o;x<c&&(l/=c/x,c=x),I<=l&&I<=c&&(i.drawImage(n,l/-2,c/-2,l,c),i.translate(0,c/2+C))}i.fillStyle=v?"white":"black",i.font=_+"px HelveticaNeue-CondensedBold";var u=h.name||h.short_name||document.title,s=i.measureText(u).width;if(s<.8*r)i.fillText(u,s/-2,0);else for(var f=u.split(/\s+/g),d=1;d<=f.length;++d){var p=f.slice(0,d).join(" "),m=i.measureText(p).width;(d===f.length||.6*r<m)&&(i.fillText(p,m/-2,0),i.translate(0,1.2*_),f.splice(0,d),d=0)}return function(){var e=document.createElement("link");return e.setAttribute("rel","apple-touch-startup-image"),e.setAttribute("media","(orientation: "+t+")"),e.setAttribute("href",i.canvas.toDataURL()),e}}function b(e){var t=g(screen,"portrait",e),n=g({width:screen.availHeight,height:screen.availWidth},"landscape",e);window.setTimeout(function(){document.head.appendChild(t()),window.setTimeout(function(){document.head.appendChild(n())},10)},10)}d&&O("apple-itunes-app","app-id="+d),O("apple-mobile-web-app-capable",c),O("apple-mobile-web-app-title",h.short_name||h.name);var w=t[0],y=new Image;if(y.crossOrigin="anonymous",y.onerror=function(){b()},!t.length)return y.onerror();y.onload=function(){if(b(y),h.background_color){var e=M(y,h.background_color);e&&(w.href=e,t.slice(1).forEach(function(t){var n=new Image;n.crossOrigin="anonymous",n.onload=function(){var e=M(n,h.background_color,!0);t.href=e},n.src=t.href}))}},y.src=w.href}(JSON.parse(r.responseText),n)}catch(e){console.warn("pwacompat.js error",e)}},r.send(null)}function A(e,t){var n=document.createElement(e);for(var r in t)n.setAttribute(r,t[r]);return document.head.appendChild(n),n}function O(e,t){t&&(!0===t&&(t="yes"),A("meta",{name:e,content:t}))}function z(e){var t=l(e);return{r:t[0],g:t[1],b:t[2],a:t[3]}}function l(e){var t=B();return t.fillStyle=e,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data}function L(e){var t,n,r,a=l(e);for(var o in a){var i=a[o]/255;a[o]=i<.03928?i/12.92:Math.pow((i+.055)/1.055,2.4)}return 3<Math.abs(1.05/(t=a.r,n=a.g,r=a.b,.2126*t+.7152*n+.0722*r+.05))}function M(e,t,n){void 0===n&&(n=!1);var r=B(e);if((r.drawImage(e,0,0),!n)&&255==r.getImageData(0,0,1,1).data[3])return;return r.globalCompositeOperation="destination-over",r.fillStyle=t,r.fillRect(0,0,e.width,e.height),r.canvas.toDataURL()}function B(e){var t=void 0===e?{width:1,height:1}:e,n=t.width,r=t.height,a=document.createElement("canvas");return a.width=n,a.height=r,a.getContext("2d")}"complete"===document.readyState?t():window.addEventListener("load",t)}();